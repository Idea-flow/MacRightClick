总结：为避免“访问其他 App 数据”弹窗，我们做了以下方案

最终采用的方案（正在使用）

Finder 扩展不再写任何文件

不写日志文件、不读模板、不读授权数据。
只负责：收集路径 + 发消息。
App 负责所有文件写入

App 使用安全书签（security-scoped bookmarks）访问用户授权目录并写文件。
Finder 扩展只发 create-file 请求。
目录监听范围由 App 下发

Finder 扩展启动时 directoryURLs = []
App 将“用户授权目录列表”通过通信下发给扩展，避免监听 /Users 造成弹窗。
日志通信改为分布式通知

扩展只发 DistributedNotificationCenter 消息
App 收到后才写入日志文件
避免扩展访问 App Group 目录导致弹窗。
最终使用的技术/方案

Finder Sync 扩展（FIFinderSync）
只负责菜单与路径获取，不做磁盘读写。

DistributedNotificationCenter 通信
扩展 ↔ App 进程间传递：

update-scope（授权目录）
update-templates（模板列表）
create-file（创建文件请求）
log（扩展日志）
安全书签（security-scoped bookmarks）
App 存储用户授权目录书签，并在创建文件时 startAccessingSecurityScopedResource()。

App Group + UserDefaults
仅在 App 中存储模板和授权目录；扩展不直接读取，避免弹窗。

效果

Finder 打开不会弹窗
右键菜单正常出现
文件由 App 创建成功
仅在“用户首次授权目录”时出现系统弹窗（不可绕过）
如果你需要进一步优化性能或做“App 未运行时仍可创建文件”的方案，我可以继续扩展。