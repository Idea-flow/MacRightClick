右键菜单 有很多功能,
例如在.contextualMenuForContainer: // 空白区域
   有新建文件(有二级列表)(已经实现),常用目录(有二级列表),常用app(有二级列表),进入终端(进入的目录是当前文件夹),拷贝路径

例如在.contextualMenuForItems: // items
   复制当前路径(已经实现),移动到(是个二级列表,从常用目录里选)

例如在 .toolbarItemMenu点击工具栏图标显示的菜单
  规划一些有用的功能

例如在 .contextualMenuForSidebar 右键点击侧栏显示的菜单
  规划一些有用的功能

这些功能是否开启,以及有什么内容,都需要进行页面配置,如果布局,让用户看着不凌乱,用着舒服呢,规划一个方案,给出合理的布局和ui,以及开发方案,先开发那个,和调整那个,
输出文档到 /Users/wangpenglong/projects/swift/MacRightClick/AI/plan 目录下,中文回复







进入到终端:
  方案 A（推荐）：使用 Apple Events/AppleScript

  通过 AppleScript 打开 Terminal 并 cd 到目录
  需要新增权限：com.apple.security.automation.apple-events
  需要在 Info.plist 加 NSAppleEventsUsageDescription（会弹一次系统授权）

  这个方案 可以只在 用户点击进入终端的时候提示吗, 且只有第一次提示, 其他功能不会有这个弹窗




后续阶段（下一步）
如果你确认第一阶段 OK，我继续做：

常用目录 / 常用 App 管理页
Move To（从常用目录里选）
工具栏菜单 + 侧边栏菜单规划


问题根因：representedObject 在 Finder 菜单回调里仍然不稳定，导致点击时拿不到 path/bundleID。
我改为 tag 映射方案，完全避开 ObjC bridging。

修复方式：

在扩展内用 favoriteAppByTag / favoriteFolderByTag 存模型
菜单项只保存 tag
点击时用 tag 找回模型，肯定有 path + bundleID


移动:

之前的功能完成啦,做的很棒, 开发下一步
移动功能, 这个只有选择item的时候才会出现,支持文件夹和文件, 移动的位置从常用目录里选,
移动就是copy到另一个地方,再删除当前的, 这个目前的技术架构能实现吗,通作到app内完成, 还是直接在finder中直接完成呢, 优先不需要弹窗授权的方案, 给出方案,我确认后再开发


之前的功能完成啦,做的很棒, 开发下一步
移动功能, 这个只有选择item的时候才会出现,支持文件夹和文件, 移动的位置从常用目录里选,
移动就是copy到另一个地方,再删除当前的, 这个目前的技术架构能实现吗,通作到app内完成, 还是直接在finder中直接完成呢, 优先不需要弹窗授权的方案, 给出方案,我确认后再开发


先给方案与取舍，不改代码。

**结论**  
在你现在的架构下，**“移动”必须由主 App 执行**，否则 Finder 扩展直接操作文件会更容易触发权限弹窗（尤其是跨目录）。  
要尽量不弹窗，最佳方式是 **主 App 用安全书签对“源目录 + 目标目录”做授权，然后在 App 内执行 copy+delete**。

---

## 方案 A（推荐，最稳、不弹窗）
**流程**
1. Finder 扩展：右键 `item` 菜单 -> “移动到” -> 选择常用目录
2. 扩展只发送通知：
    - `action: move-items`
    - `targets: [选中的文件/文件夹路径]`
    - `target: 目标目录路径`
3. 主 App：
    - 检查“源目录是否在授权范围”
    - 检查“目标目录是否在授权范围”
    - 通过安全书签拿到权限后执行 **copy → delete**
    - 逐项写日志（成功/失败/失败原因）

**优点**
- 可控、可记录日志
- 权限弹窗仅在“未授权时”出现
- 不依赖 Finder 扩展直接操作文件系统

**缺点**
- 需要保证源和目标目录都已授权  
  （否则会弹窗，或失败）

---

## 方案 B（不推荐）
**扩展直接移动**
- 扩展调用 `FileManager` 或 `NSWorkspace` 在 Finder 进程内完成
- 极容易触发权限弹窗
- 扩展无法持久保存安全书签
- 容易失败且不可控

---

## 你需要确认
1. **移动是否必须避免任何授权弹窗？**
    - 如果用户操作的源或目标未授权，是否允许弹窗一次？
2. 是否允许 **“未授权就禁止移动”** 并给出提示？

---

如果你确认“用方案 A”，我就开始开发：
- Finder 扩展新增 `移动到` 二级菜单
- 通知发送 `move-items`
- App 端实现 copy+delete（带日志）
- 未授权明确提示原因

自定义图标:

1. 这个 App 好像是启用了了沙盒   目前不准备上架 Mac App Store 但是以后准备
   2.允许彩色,也可以是图片
   3.允许常见的就行
   4.是 SwiftUI 的 Settings 窗口
   给出开发文档,并开发
   开发的代码要有注释,最好模块化
